<!DOCTYPE html>
<html>
  <head>
    <title>Grid of Icons</title>
  </head>
  <body>
    <div id="grid"></div>
    <script>
      const grid = document.getElementById("grid");
      const icons = [
        "icon1.png",
        "icon2.png",
        "icon3.png",
        "icon4.png",
        "icon5.png",
        "icon6.png",
      ];
      const rows = 4;
      const cols = 3;
      const iconWidth = 100;
      const iconHeight = 100;
      let draggedIcon = null;

      function handleDragStart(e) {
        draggedIcon = e.target;
        e.dataTransfer.effectAllowed = "move";
        e.dataTransfer.setData("text/html", draggedIcon.outerHTML);
        e.target.classList.add("dragging");
      }

      function handleDragOver(e) {
        if (e.preventDefault) {
          e.preventDefault();
        }
        e.dataTransfer.dropEffect = "move";
        return false;
      }

      function handleDrop(e) {
        if (e.stopPropagation) {
          e.stopPropagation();
        }
        if (draggedIcon !== e.target) {
          const dropIcon = e.target;
          const dropHTML = dropIcon.outerHTML;
          dropIcon.outerHTML = draggedIcon.outerHTML;
          draggedIcon.outerHTML = dropHTML;
          const newDraggedIcon = dropIcon.previousSibling;
          newDraggedIcon.addEventListener("dragstart", handleDragStart);
          newDraggedIcon.addEventListener("dragend", handleDragEnd);
          draggedIcon = newDraggedIcon;
        }
        return false;
      }

      function handleDragEnd(e) {
        e.target.classList.remove("dragging");
        // Snap icon to nearest grid location
        const iconRect = e.target.getBoundingClientRect();
        const x = Math.round(iconRect.left / iconWidth) * iconWidth;
        const y = Math.round(iconRect.top / iconHeight) * iconHeight;
        e.target.style.left = `${x}px`;
        e.target.style.top = `${y}px`;
      }

      for (let i = 0; i < rows; i++) {
        const row = document.createElement("div");
        row.classList.add("row");

        for (let j = 0; j < cols; j++) {
          const icon = document.createElement("img");
          const randomIcon = icons[Math.floor(Math.random() * icons.length)];
          icon.src = `icons/${randomIcon}`;
          icon.classList.add("icon");
          icon.setAttribute("draggable", true);
          icon.addEventListener("dragstart", handleDragStart);
          icon.addEventListener("dragover", handleDragOver);
          icon.addEventListener("drop", handleDrop);
          icon.addEventListener("dragend", handleDragEnd);
          row.appendChild(icon);
        }

        grid.appendChild(row);
      }
    </script>
    <style>
      #grid {
        display: flex;
        flex-direction: column;
      }

      .row {
        display: flex;
        justify-content: space-around;
        margin: 10px;
      }

      .icon {
        width: 100px;
        height: 100px;
        margin: 10px;
        outline: 2px solid black;
        position: relative;
        z-index: 1;
      }

      .dragging {
        opacity: 0.5;
      }
    </style>
  </body>
</html>
